<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cricket Scorer - Fully Working</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: Arial, sans-serif; }
        body { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 1000px; margin: 0 auto; background: white; border-radius: 15px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); overflow: hidden; }
        .header { background: #1a365d; color: white; padding: 30px; text-align: center; }
        .header h1 { font-size: 2.5rem; margin-bottom: 10px; }
        .menu { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; padding: 30px; }
        .card { background: #f8fafc; border: 2px solid #e2e8f0; border-radius: 12px; padding: 25px; text-align: center; cursor: pointer; transition: all 0.3s; }
        .card:hover { transform: translateY(-5px); border-color: #4299e1; box-shadow: 0 10px 25px rgba(66, 153, 225, 0.15); }
        .card h3 { color: #2d3748; margin-bottom: 10px; font-size: 1.3rem; }
        .card p { color: #718096; line-height: 1.5; }
        .hidden { display: none; }
        .screen { padding: 30px; }
        .btn { background: #4299e1; color: white; padding: 12px 25px; border: none; border-radius: 8px; cursor: pointer; margin: 10px; font-size: 16px; font-weight: bold; }
        .btn:hover { background: #3182ce; }
        .form-group { margin: 15px 0; }
        .form-input { width: 100%; padding: 12px; border: 2px solid #cbd5e0; border-radius: 8px; font-size: 16px; }
        .form-input:focus { border-color: #4299e1; outline: none; }
        
        /* Tournament specific styles */
        .tournament-card { border: 1px solid #e2e8f0; padding: 15px; margin: 10px 0; border-radius: 8px; background: #f8fafc; }
        .tournament-card h4 { margin: 0 0 10px 0; color: #2d3748; }
        .tournament-card p { margin: 5px 0; color: #4a5568; }
        .small-btn { padding: 8px 15px; font-size: 14px; margin: 5px; }
        
        /* Player Profiles specific styles */
        .player-card { border: 1px solid #e2e8f0; padding: 20px; margin: 15px 0; border-radius: 10px; background: white; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .player-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .player-name { font-size: 1.4rem; color: #2d3748; font-weight: bold; }
        .player-type { background: #4299e1; color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.8rem; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-top: 15px; }
        .stat-card { background: #f7fafc; padding: 15px; border-radius: 8px; text-align: center; border-left: 4px solid #4299e1; }
        .stat-value { font-size: 1.5rem; font-weight: bold; color: #2d3748; }
        .stat-label { font-size: 0.8rem; color: #718096; margin-top: 5px; }
        .search-bar { width: 100%; padding: 12px; margin-bottom: 20px; border: 2px solid #cbd5e0; border-radius: 8px; font-size: 16px; }
        
        /* New styles for completed matches, local matches and statistics */
        .match-card { border: 1px solid #e2e8f0; padding: 20px; margin: 15px 0; border-radius: 10px; background: white; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .match-teams { font-size: 1.3rem; font-weight: bold; color: #2d3748; margin-bottom: 10px; }
        .match-score { font-family: monospace; font-size: 1.2rem; color: #4a5568; margin-bottom: 10px; }
        .match-result { color: #38a169; font-weight: bold; }
        .local-match-card { border: 1px solid #e2e8f0; padding: 15px; margin: 10px 0; border-radius: 8px; background: #f0fff4; }
        .live-badge { background: #e53e3e; color: white; padding: 4px 8px; border-radius: 12px; font-size: 0.7rem; font-weight: bold; }
        .upcoming-badge { background: #3182ce; color: white; padding: 4px 8px; border-radius: 12px; font-size: 0.7rem; font-weight: bold; }
        .chart-container { background: #f7fafc; padding: 20px; border-radius: 10px; margin: 15px 0; }

        /* Live Scoring Styles */
        .scoring-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 8px;
            margin-top: 10px;
        }

        .scoring-btn {
            padding: 12px 8px;
            border: none;
            border-radius: 6px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
        }

        .scoring-btn:hover {
            transform: scale(1.05);
        }

        .run-btn {
            background: #d1fae5;
            color: #065f46;
            border: 2px solid #a7f3d0;
        }

        .wicket-btn {
            background: #fee2e2;
            color: #991b1b;
            border: 2px solid #fecaca;
        }

        .extra-btn {
            background: #fef3c7;
            color: #92400e;
            border: 2px solid #fde68a;
        }

        .control-btn {
            background: #e0e7ff;
            color: #3730a3;
            border: 2px solid #c7d2fe;
        }

        .player-status {
            background: #f7fafc;
            padding: 12px;
            border-radius: 8px;
            border-left: 4px solid #4299e1;
        }

        .ball-dot {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin: 0 2px;
            text-align: center;
            line-height: 20px;
            font-size: 12px;
            font-weight: bold;
        }

        .ball-run { background: #d1fae5; color: #065f46; }
        .ball-wicket { background: #fee2e2; color: #991b1b; }
        .ball-extra { background: #fef3c7; color: #92400e; }
        .ball-dot-ball { background: #e2e8f0; color: #4a5568; }

        /* Team Setup Styles */
        .team-setup-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .team-section {
            background: #f8fafc;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
        }

        .player-list {
            max-height: 300px;
            overflow-y: auto;
            margin: 15px 0;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 10px;
        }

        .player-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            margin: 5px 0;
            background: white;
            border-radius: 6px;
            border: 1px solid #e2e8f0;
            cursor: pointer;
        }

        .player-item:hover {
            background: #ebf8ff;
            border-color: #4299e1;
        }

        .player-item.selected {
            background: #4299e1;
            color: white;
        }

        .player-role {
            font-size: 0.8rem;
            color: #718096;
            background: #f7fafc;
            padding: 2px 8px;
            border-radius: 12px;
        }

        .player-item.selected .player-role {
            background: rgba(255,255,255,0.2);
            color: white;
        }

        .batting-order {
            margin: 15px 0;
        }

        .order-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            margin: 5px 0;
            background: white;
            border-radius: 6px;
            border: 1px solid #e2e8f0;
        }

        .order-number {
            background: #4299e1;
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .bowling-lineup {
            margin: 15px 0;
        }

        .bowler-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            margin: 5px 0;
            background: white;
            border-radius: 6px;
            border: 1px solid #e2e8f0;
        }

        .fielding-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        .fielding-position {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
        }

        .fielding-position.selected {
            background: #4299e1;
            color: white;
            border-color: #4299e1;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Home Screen -->
        <div class="header">
            <h1>üèè CRICHIT - Cricket Scorer</h1>
            <p>Professional Cricket Scoring Application</p>
        </div>

        <div id="homeScreen">
            <div class="menu">
                <div class="card" onclick="showScreen('setup')">
                    <h3>‚ûï New Match</h3>
                    <p>Start scoring a new cricket match with live updates and player statistics</p>
                </div>
                
                <div class="card" onclick="showScreen('teamSetup')">
                    <h3>üë• Team Setup</h3>
                    <p>Create teams with 11 players, batting order, bowling lineup and fielding positions</p>
                </div>
                
                <div class="card" onclick="showScreen('tournaments')">
                    <h3>üèÜ Tournaments</h3>
                    <p>Create and manage cricket tournaments with multiple teams and matches</p>
                </div>
                
                <div class="card" onclick="showScreen('players')">
                    <h3>üë§ Player Profiles</h3>
                    <p>View detailed player statistics, performance history and rankings</p>
                </div>
                
                <div class="card" onclick="showScreen('matches')">
                    <h3>üìä Completed Matches</h3>
                    <p>Browse through complete match history with scores and results</p>
                </div>
                
                <div class="card" onclick="showScreen('local')">
                    <h3>üìç Local Matches</h3>
                    <p>Find and join local cricket matches in your area</p>
                </div>
                
                <div class="card" onclick="showScreen('stats')">
                    <h3>üìà Live Statistics</h3>
                    <p>Real-time match statistics and player performance analytics</p>
                </div>
            </div>
        </div>

        <!-- Setup Screen -->
        <div id="setupScreen" class="screen hidden">
            <h2>üéØ New Match Setup</h2>
            <div class="form-group">
                <input type="text" class="form-input" placeholder="üèè Team A Name" id="teamA">
            </div>
            <div class="form-group">
                <input type="text" class="form-input" placeholder="üèè Team B Name" id="teamB">
            </div>
            <div class="form-group">
                <select class="form-input" id="matchType">
                    <option>20 Overs Match</option>
                    <option>50 Overs Match</option>
                    <option>Test Match (5 Days)</option>
                    <option>T10 Match</option>
                </select>
            </div>
            <button class="btn" onclick="startMatch()">üöÄ Start Match</button>
            <button class="btn" onclick="showScreen('home')" style="background: #718096;">‚Üê Back to Home</button>
        </div>

        <!-- Team Setup Screen -->
        <div id="teamSetupScreen" class="screen hidden">
            <div style="text-align: center; margin-bottom: 30px;">
                <h2>üë• Team Setup</h2>
                <p>Create complete teams with players, batting order, bowling lineup and fielding positions</p>
            </div>

            <div class="card">
                <h3>üèè Create New Team</h3>
                <div class="form-group">
                    <input type="text" class="form-input" placeholder="Team Name" id="teamName">
                </div>
                
                <div class="team-setup-container">
                    <!-- Team A Section -->
                    <div class="team-section">
                        <h4>Team Players Selection</h4>
                        <div class="player-list" id="availablePlayers">
                            <!-- Players will be loaded here -->
                        </div>
                        <div style="text-align: center; margin: 10px 0;">
                            <span id="selectedCount">0/11 players selected</span>
                        </div>
                    </div>

                    <!-- Selected Players Section -->
                    <div class="team-section">
                        <h4>Selected Players</h4>
                        <div class="player-list" id="selectedPlayers">
                            <!-- Selected players will appear here -->
                        </div>
                        <button class="btn small-btn" onclick="clearSelection()" style="background: #e53e3e;">
                            Clear All
                        </button>
                    </div>
                </div>

                <!-- Batting Order -->
                <div class="batting-order">
                    <h4>ü¶á Batting Order</h4>
                    <div id="battingOrderList">
                        <p style="color: #666; text-align: center;">Select players first to set batting order</p>
                    </div>
                </div>

                <!-- Bowling Lineup -->
                <div class="bowling-lineup">
                    <h4>üéØ Bowling Lineup</h4>
                    <div id="bowlingLineupList">
                        <p style="color: #666; text-align: center;">Select bowlers from your team</p>
                    </div>
                </div>

                <!-- Fielding Positions -->
                <div class="fielding-positions">
                    <h4>üß§ Fielding Positions</h4>
                    <div class="fielding-grid">
                        <div class="fielding-position" data-position="wicketkeeper">WK</div>
                        <div class="fielding-position" data-position="slip">Slip</div>
                        <div class="fielding-position" data-position="gully">Gully</div>
                        <div class="fielding-position" data-position="point">Point</div>
                        <div class="fielding-position" data-position="cover">Cover</div>
                        <div class="fielding-position" data-position="midoff">Mid Off</div>
                        <div class="fielding-position" data-position="midon">Mid On</div>
                        <div class="fielding-position" data-position="midwicket">Mid Wicket</div>
                        <div class="fielding-position" data-position="squareleg">Square Leg</div>
                        <div class="fielding-position" data-position="fineleg">Fine Leg</div>
                        <div class="fielding-position" data-position="thirdman">Third Man</div>
                        <div class="fielding-position" data-position="longon">Long On</div>
                    </div>
                </div>

                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn" onclick="saveTeam()" style="background: #38a169;">
                        üíæ Save Team
                    </button>
                    <button class="btn" onclick="showScreen('home')" style="background: #718096;">
                        ‚Üê Back to Home
                    </button>
                </div>
            </div>

            <div class="card">
                <h3>üìã Saved Teams</h3>
                <div id="savedTeamsList">
                    <p style="color: #666; text-align: center;">No teams saved yet</p>
                </div>
            </div>
        </div>

        <!-- Live Scoring Screen -->
        <div id="scoringScreen" class="screen hidden">
            <!-- ... (same as before) ... -->
        </div>

        <!-- Tournament Screen -->
        <div id="tournamentsScreen" class="screen hidden">
            <!-- ... (same as before) ... -->
        </div>

        <!-- Player Profiles Screen -->
        <div id="playersScreen" class="screen hidden">
            <!-- ... (same as before) ... -->
        </div>

        <!-- Completed Matches Screen -->
        <div id="matchesScreen" class="screen hidden">
            <!-- ... (same as before) ... -->
        </div>

        <!-- Local Matches Screen -->
        <div id="localScreen" class="screen hidden">
            <!-- ... (same as before) ... -->
        </div>

        <!-- Live Statistics Screen -->
        <div id="statsScreen" class="screen hidden">
            <!-- ... (same as before) ... -->
        </div>
    </div>

    <script>
        // Team Management System
        let currentTeam = {
            name: '',
            players: [],
            battingOrder: [],
            bowlingLineup: [],
            fieldingPositions: {}
        };

        let availablePlayers = [];

        // Initialize Team Setup
        function initializeTeamSetup() {
            loadAvailablePlayers();
            updateAvailablePlayersList();
            updateSavedTeamsList();
        }

        // Load available players from stored players
        function loadAvailablePlayers() {
            const storedPlayers = getPlayers();
            if (storedPlayers.length > 0) {
                availablePlayers = storedPlayers;
            } else {
                // Create sample players if none exist
                availablePlayers = [
                    { id: 1, name: 'Virat Kohli', type: 'batsman', role: 'Top Order Batsman' },
                    { id: 2, name: 'Rohit Sharma', type: 'batsman', role: 'Opening Batsman' },
                    { id: 3, name: 'Jasprit Bumrah', type: 'bowler', role: 'Fast Bowler' },
                    { id: 4, name: 'Ravindra Jadeja', type: 'allrounder', role: 'All-Rounder' },
                    { id: 5, name: 'MS Dhoni', type: 'wicketkeeper', role: 'Wicket Keeper' },
                    { id: 6, name: 'Hardik Pandya', type: 'allrounder', role: 'All-Rounder' },
                    { id: 7, name: 'Rishabh Pant', type: 'wicketkeeper', role: 'Wicket Keeper' },
                    { id: 8, name: 'Mohammed Shami', type: 'bowler', role: 'Fast Bowler' },
                    { id: 9, name: 'KL Rahul', type: 'batsman', role: 'Top Order Batsman' },
                    { id: 10, name: 'Yuzvendra Chahal', type: 'bowler', role: 'Spinner' },
                    { id: 11, name: 'Shikhar Dhawan', type: 'batsman', role: 'Opening Batsman' },
                    { id: 12, name: 'Bhuvneshwar Kumar', type: 'bowler', role: 'Fast Bowler' },
                    { id: 13, name: 'Ravichandran Ashwin', type: 'bowler', role: 'Spinner' },
                    { id: 14, name: 'Shreyas Iyer', type: 'batsman', role: 'Middle Order Batsman' },
                    { id: 15, name: 'Washington Sundar', type: 'allrounder', role: 'All-Rounder' }
                ];
            }
        }

        // Update available players list
        function updateAvailablePlayersList() {
            const availablePlayersList = document.getElementById('availablePlayers');
            availablePlayersList.innerHTML = availablePlayers.map(player => `
                <div class="player-item" onclick="selectPlayer(${player.id})" 
                     data-player-id="${player.id}">
                    <div>
                        <strong>${player.name}</strong>
                        <div class="player-role">${player.role || player.type}</div>
                    </div>
                    <div style="font-size: 0.8rem; color: #718096;">
                        ${player.type}
                    </div>
                </div>
            `).join('');
        }

        // Select player for team
        function selectPlayer(playerId) {
            if (currentTeam.players.length >= 11) {
                alert('Team already has 11 players. Remove some players to add new ones.');
                return;
            }

            const player = availablePlayers.find(p => p.id === playerId);
            if (player && !currentTeam.players.find(p => p.id === playerId)) {
                currentTeam.players.push(player);
                updateSelectedPlayersList();
                updateBattingOrderList();
                updateBowlingLineupList();
            }
        }

        // Remove player from team
        function removePlayer(playerId) {
            currentTeam.players = currentTeam.players.filter(p => p.id !== playerId);
            currentTeam.battingOrder = currentTeam.battingOrder.filter(p => p.id !== playerId);
            currentTeam.bowlingLineup = currentTeam.bowlingLineup.filter(p => p.id !== playerId);
            updateSelectedPlayersList();
            updateBattingOrderList();
            updateBowlingLineupList();
        }

        // Update selected players list
        function updateSelectedPlayersList() {
            const selectedPlayersList = document.getElementById('selectedPlayers');
            const selectedCount = document.getElementById('selectedCount');
            
            selectedCount.textContent = `${currentTeam.players.length}/11 players selected`;
            
            if (currentTeam.players.length === 0) {
                selectedPlayersList.innerHTML = '<p style="color: #666; text-align: center;">No players selected</p>';
                return;
            }

            selectedPlayersList.innerHTML = currentTeam.players.map(player => `
                <div class="player-item">
                    <div>
                        <strong>${player.name}</strong>
                        <div class="player-role">${player.role || player.type}</div>
                    </div>
                    <button class="small-btn" onclick="removePlayer(${player.id})" 
                            style="background: #e53e3e; color: white; border: none; padding: 4px 8px; border-radius: 4px;">
                        Remove
                    </button>
                </div>
            `).join('');
        }

        // Update batting order list
        function updateBattingOrderList() {
            const battingOrderList = document.getElementById('battingOrderList');
            
            if (currentTeam.players.length === 0) {
                battingOrderList.innerHTML = '<p style="color: #666; text-align: center;">Select players first to set batting order</p>';
                return;
            }

            // Auto-generate batting order based on player types
            if (currentTeam.battingOrder.length === 0) {
                const batsmen = currentTeam.players.filter(p => p.type === 'batsman' || p.type === 'wicketkeeper');
                const allrounders = currentTeam.players.filter(p => p.type === 'allrounder');
                const bowlers = currentTeam.players.filter(p => p.type === 'bowler');
                
                currentTeam.battingOrder = [...batsmen, ...allrounders, ...bowlers];
            }

            battingOrderList.innerHTML = currentTeam.battingOrder.map((player, index) => `
                <div class="order-item">
                    <div class="order-number">${index + 1}</div>
                    <div style="flex: 1; margin-left: 10px;">
                        <strong>${player.name}</strong>
                        <div class="player-role">${player.role || player.type}</div>
                    </div>
                    <div style="display: flex; gap: 5px;">
                        <button class="small-btn" onclick="movePlayerUp(${index})" 
                                ${index === 0 ? 'disabled' : ''}
                                style="background: #4299e1; color: white; border: none; padding: 4px 8px; border-radius: 4px;">
                            ‚Üë
                        </button>
                        <button class="small-btn" onclick="movePlayerDown(${index})" 
                                ${index === currentTeam.battingOrder.length - 1 ? 'disabled' : ''}
                                style="background: #4299e1; color: white; border: none; padding: 4px 8px; border-radius: 4px;">
                            ‚Üì
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Move player up in batting order
        function movePlayerUp(index) {
            if (index > 0) {
                const temp = currentTeam.battingOrder[index];
                currentTeam.battingOrder[index] = currentTeam.battingOrder[index - 1];
                currentTeam.battingOrder[index - 1] = temp;
                updateBattingOrderList();
            }
        }

        // Move player down in batting order
        function movePlayerDown(index) {
            if (index < currentTeam.battingOrder.length - 1) {
                const temp = currentTeam.battingOrder[index];
                currentTeam.battingOrder[index] = currentTeam.battingOrder[index + 1];
                currentTeam.battingOrder[index + 1] = temp;
                updateBattingOrderList();
            }
        }

        // Update bowling lineup list
        function updateBowlingLineupList() {
            const bowlingLineupList = document.getElementById('bowlingLineupList');
            
            const bowlers = currentTeam.players.filter(p => p.type === 'bowler' || p.type === 'allrounder');
            
            if (bowlers.length === 0) {
                bowlingLineupList.innerHTML = '<p style="color: #666; text-align: center;">No bowlers in the team</p>';
                return;
            }

            // Auto-select bowlers for lineup
            if (currentTeam.bowlingLineup.length === 0) {
                currentTeam.bowlingLineup = bowlers;
            }

            bowlingLineupList.innerHTML = currentTeam.bowlingLineup.map((player, index) => `
                <div class="bowler-item">
                    <div>
                        <strong>${player.name}</strong>
                        <div class="player-role">${player.role || player.type}</div>
                    </div>
                    <div style="font-size: 0.8rem; color: #718096;">
                        ${index === 0 ? 'üéØ Opening' : index === 1 ? 'üéØ First Change' : 'üéØ Bowler'}
                    </div>
                </div>
            `).join('');
        }

        // Clear all selection
        function clearSelection() {
            currentTeam = {
                name: '',
                players: [],
                battingOrder: [],
                bowlingLineup: [],
                fieldingPositions: {}
            };
            updateSelectedPlayersList();
            updateBattingOrderList();
            updateBowlingLineupList();
        }

        // Save team
        function saveTeam() {
            const teamName = document.getElementById('teamName').value;
            
            if (!teamName) {
                alert('Please enter a team name');
                return;
            }

            if (currentTeam.players.length !== 11) {
                alert('Please select exactly 11 players for the team');
                return;
            }

            currentTeam.name = teamName;
            currentTeam.id = Date.now();
            currentTeam.createdAt = new Date().toLocaleDateString();

            // Save to localStorage
            const savedTeams = getSavedTeams();
            savedTeams.push(currentTeam);
            localStorage.setItem('saved_teams', JSON.stringify(savedTeams));

            alert(`üéâ Team "${teamName}" saved successfully!`);
            updateSavedTeamsList();
            clearSelection();
            document.getElementById('teamName').value = '';
        }

        // Get saved teams from localStorage
        function getSavedTeams() {
            const data = localStorage.getItem('saved_teams');
            return data ? JSON.parse(data) : [];
        }

        // Update saved teams list
        function updateSavedTeamsList() {
            const savedTeamsList = document.getElementById('savedTeamsList');
            const savedTeams = getSavedTeams();
            
            if (savedTeams.length === 0) {
                savedTeamsList.innerHTML = '<p style="color: #666; text-align: center;">No teams saved yet</p>';
                return;
            }

            savedTeamsList.innerHTML = savedTeams.map(team => `
                <div class="tournament-card">
                    <h4>${team.name}</h4>
                    <p>üë• ${team.players.length} Players</p>
                    <p>üìÖ Created: ${team.createdAt}</p>
                    <p>ü¶á Batting: ${team.battingOrder.slice(0, 3).map(p => p.name).join(', ')}...</p>
                    <p>üéØ Bowling: ${team.bowlingLineup.slice(0, 2).map(p => p.name).join(', ')}...</p>
                    <button class="btn small-btn" onclick="loadTeam(${team.id})" style="background: #4299e1;">
                        Load Team
                    </button>
                    <button class="btn small-btn" onclick="deleteTeam(${team.id})" style="background: #e53e3e;">
                        Delete
                    </button>
                </div>
            `).join('');
        }

        // Load team
        function loadTeam(teamId) {
            const savedTeams = getSavedTeams();
            const team = savedTeams.find(t => t.id === teamId);
            if (team) {
                currentTeam = JSON.parse(JSON.stringify(team)); // Deep copy
                document.getElementById('teamName').value = team.name;
                updateSelectedPlayersList();
                updateBattingOrderList();
                updateBowlingLineupList();
                alert(`Team "${team.name}" loaded successfully!`);
            }
        }

        // Delete team
        function deleteTeam(teamId) {
            if (confirm('Are you sure you want to delete this team?')) {
                const savedTeams = getSavedTeams();
                const filtered = savedTeams.filter(t => t.id !== teamId);
                localStorage.setItem('saved_teams', JSON.stringify(filtered));
                updateSavedTeamsList();
                alert('Team deleted successfully!');
            }
        }

        // Fielding position selection
        document.addEventListener('DOMContentLoaded', function() {
            // Fielding position click handlers
            document.querySelectorAll('.fielding-position').forEach(position => {
                position.addEventListener('click', function() {
                    this.classList.toggle('selected');
                    const positionName = this.getAttribute('data-position');
                    // Store fielding position selection
                    // Implementation can be extended based on requirements
                });
            });
        });

        // ... (rest of your existing JavaScript code remains the same) ...

        function showScreen(screenName) {
            // Hide all screens
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.add('hidden');
            });
            
            // Show selected screen
            document.getElementById(screenName + 'Screen').classList.remove('hidden');
            
            // Hide home screen if showing other screen
            if(screenName !== 'home') {
                document.getElementById('homeScreen').classList.add('hidden');
            } else {
                document.getElementById('homeScreen').classList.remove('hidden');
            }

            // Load data when screens are shown
            if(screenName === 'tournaments') {
                updateTournamentList();
            }
            if(screenName === 'players') {
                updatePlayersList();
            }
            if(screenName === 'matches') {
                updateMatchesList();
            }
            if(screenName === 'local') {
                findLocalMatches();
            }
            if(screenName === 'stats') {
                updateStatistics();
            }
            if(screenName === 'teamSetup') {
                initializeTeamSetup();
            }
        }

        // ... (rest of your existing functions remain the same) ...

        // Update startMatch function to use team setup
        function startMatch() {
            const teamA = document.getElementById('teamA').value;
            const teamB = document.getElementById('teamB').value;
            
            if(teamA && teamB) {
                // Check if teams are saved
                const savedTeams = getSavedTeams();
                const teamAExists = savedTeams.find(t => t.name === teamA);
                const teamBExists = savedTeams.find(t => t.name === teamB);
                
                if (!teamAExists || !teamBExists) {
                    if (confirm('One or both teams are not saved. Would you like to set up teams first?')) {
                        showScreen('teamSetup');
                        return;
                    }
                }

                // Toss simulation
                const tossWinner = Math.random() > 0.5 ? teamA : teamB;
                const decision = Math.random() > 0.5 ? 'bat' : 'bowl';
                const battingTeam = decision === 'bat' ? tossWinner : (tossWinner === teamA ? teamB : teamA);
                
                startLiveMatch(teamA, teamB, battingTeam);
            } else {
                alert('Please enter both team names to start the match');
            }
        }

        // ... (rest of your existing code remains the same) ...
    </script>
</body>
</html>
